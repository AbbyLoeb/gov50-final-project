---
title: "Gov 50 Final Project"
author: "Abby Loeb"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---

```{r}
library(tidyverse)
library(ggplot2)
averages <- read_csv("averages.csv")
```

## Dataset description

Does being elected from a swing state change how often a congressional member votes in alignment with Trump? I plan to study how often various representatives vote in alignment with Donald Trump's stated policy positions. I hypothesize that congressional members from swing states will vote closer to the median Trump vote, for both parties relative to the overall party median Trump vote. I expect that these members will, on average, vote closer to the overall median in order to win re-election in a competitive seat where a member must apply to undecided or voters who feel as though they are in the middle of each party ideologically. I'll be looking at the `state` and `net_trump_vote` variables of each member. The `net_trump_vote` is measured on a scale of -1 to 1, where -1 are more votes against Trump. I also may group these members by `state` and `party` and then analyze the `net_trump_vote` across these groups to get a better understanding of how a member's party and and state effect their voting patterns. I expect that the difference in the `net_trump_vote` between the two `party` groups within a singular swing state will be less than the respective `party` `net_trump_vote` in non-swing states. My hypothesis would be disproven if there was no considerable difference in the difference of the `net_trump_vote` between parties in swing states versus non-swing states.



## Milestone 3

```{r}
library(ggplot2)
library(tidyverse)
library(dplyr)
averages <- read_csv("averages.csv")
averages
```
```{r}
average_agree <- averages |>
  group_by(state) |>
  summarize(avg_agree_pct = mean(agree_pct))

average_agree |>
  slice_max(avg_agree_pct, n = 50) |>
  ggplot(mapping = aes(x = avg_agree_pct, y = state)) +
  geom_col() +
  labs(
    x = "Average vote percent with Trump by state",
    y = "State",
    title = "Average agreement with Trump by state"
  )
```

These graphs show no obvious pattern based on state alone, with the average Trump vote aligning with the overall political tilt of the specific state. More Democratic states have representatives who tend to vote less with Trump on average, and Republican-leaning states are represented by House members who tend to vote more with Trump on average.

This makes clear that we need to further break down the data in swing states by party and/or member to understand how members from swing states vote differently from other members of their party and whether this correlates with being elected by a district in a swing state or not.

## Milestone 4

```{r}
averages <- averages |>
  mutate(swing = case_when(
    state == "FL" ~ "Swing State", 
    state == "NC" ~ "Swing State", 
    state == "OH" ~ "Swing State", 
    state == "NV" ~ "Swing State", 
    state == "PA" ~ "Swing State",
    state == "MI" ~ "Swing State",
    state == "WI" ~ "Swing State",
    state == "AZ" ~ "Swing State"
  )) |>
  mutate(swing = if_else(is.na(swing), "Not Swing State", "Swing State")) |>
  mutate(party = case_when(
    party == "D" ~ "Democrat",
    party == "Democrat" ~ "Democrat",
    party == "R" ~ "Republican",
    party == "Republican"~"Republican",
    party == "I" ~ "Independent",
    party == "Independent" ~ "Independent",
    party == "Libertarian" ~ "Libertarian"
  )) |>
  drop_na(net_trump_vote, party)
averages <- averages |>
  subset(party == "Democrat" | party == "Republican")
``` 


```{r}
DiM_party<-averages |>
  group_by(party) |>
  summarize(mean_ntv = mean(net_trump_vote)) |>
  pivot_wider(
    names_from = party,
    values_from = mean_ntv
  )

knitr::kable(DiM_party)

DiM_swing <- averages |>
  group_by(swing, party) |>
  summarize(mean_ntv = mean(net_trump_vote)) |>
  pivot_wider(
    names_from = swing,
    values_from = mean_ntv
  ) |>
  mutate(ntv_diff = `Swing State` - `Not Swing State`)
DiM_swing
knitr::kable(DiM_swing)
```

```{r}
averages |>
  group_by(swing, party) |>
  summarize(mean_ntv = mean(net_trump_vote)) |>
  ggplot(aes(x = party, y = mean_ntv, fill = swing)) +
  geom_col() +
  scale_fill_manual(values = c(`Swing State` = "goldenrod1", `Not Swing State` = "goldenrod")) +
  labs(
    x = "Party of Officeholder",
    y = "Mean number of votes in accordance with Trump",
    title = "Average votes in accordance with Trump for 115-117 Congress",
    caption = "Source: FiveThirtyEight"
  )

```







